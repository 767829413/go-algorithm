[
              {
                "id": "did:wlk:xxxxxxxx#info", //"协议did拼上service的类型,创建时自动生成"
                "type": "info", //"service的类型,创建时自动生成"
                "appid": "xxxxxxx", //"产物的appid,创建时自动生成"
                "version": "xxxxx", //"产物的version,创建时自动生成"
                "name": "xxxx", //"产物的名称,创建时自动生成"
                "sub_org_key": "xxxxx", //"产物所在机构的key,创建时自动生成"
                "app_type": "app/service/infrastructure/npm/composer/....", //"产物的类型,创建时自动生成"
                "sku_id": "", //""
                "related_protocol": [], //"产物引用的一级服务的部署协议数组,创建时自动生成"
                "related_operator_protocol": "did:wlk:xxxxxxxx" //"如果是运营商部署协议会关联对应部署协议的id,创建时自动生成"
              },
              {
                "id": "did:wlk:xxxx#topo", //"协议did拼上service的类型,创建时自动生成"
                "type": "topo", //"service的类型,创建时自动生成"
                "data": [
                  {
                    "appid": "appid",
                    "version": "1.0.0",
                    "target_channel": {
                      "mode": "static/dynamic", //"【用户填写】部署模式,必填,默认是静态部署,在产品拓扑模块设置"
                      "data": "", //"【用户填写】channeldata,默认为空,非必填,,在产品拓扑模块设置"
                      "alias": "", //"【用户填写】引用别名,默认为空,非必填,在产品拓扑模块设置"
                      "dynamic_mode": "", //"【用户填写】"
                      "site": "", //"【用户填写】"
                      "group": "" // "【用户填写】动态分配是的group信息,在一个group里的节点会一起部署,非必填,在产品拓扑模块设置"
                    },
                    "name": "", //"主节点的名称,创建时自动生成"
                    "site": "sitea",
                    "is_unique": "", //"【用户填写】0 | 1 ,容灾模式时,某个节点挂了,该节点是否重新部署"
                    "operator": {
                      "endpoint": "xxxxxx?action=add/remove", //"【用户填写】接口地址,用于部署询问运营商节点分配通道的接口,必填,默认空，action=remove的时候以post的方式传入channels字段，字段为json序列化后的数组[{'appkey', 'channel', 'sub_org_key'}]"
                      "operator_protocol": "OPERATOR_PROTOCOL", //""
                      "operator_photo": "", //"【用户填写】运营商照片,必填,默认为空"
                      "operator_name": "", //"【用户填写】运营商名称,必填,默认为空"
                      "origin_operator_protocol": "", //""
                      "disaster_recovery_strategy": "" //"容灾策略,预留字段"
                    },
                    "action": {
                      "type": "tranfer|backup|import", //""
                      "resources": [
                        {
                          "type": "mysql",
                          "properties": {
                            "host": "",
                            "port": "",
                            "user": "",
                            "password": "",
                            "logic_instance_key": ""
                          }
                        }
                      ]
                    },
                    "children": [
                      {
                        "appid": "appid1",
                        "version": "",
                        "target_channel": {
                          "mode": "static/dynamic",
                          "data": "",
                          "alias": "",
                          "dynamic_mode": "",
                          "site": "",
                          "group": "" // 动态分配是的group信息
                        }
                      }
                    ],
                    "properties": {
                      "no_need_assign_channel": "0", // 是否分配通道
                      "no_need_deploy": "0" // 是否部署
                    }
                  },
                  {
                    "appid": "appid1",
                    "version": "",
                    "sku_id": "",
                    "site": "",
                    "is_unique": "",
                    "operator": {
                      "endpoint": "xxxxxx", // post operator/assignChannel {'sub_org_key': '', 'org_name':'', 'parent_appkey':'', 'parent_channel':'', extra:''}
                      "operator_protocol": "OPERATOR_PROTOCOL",
                      "operator_photo": "",
                      "operator_parent_field": "",
                      "operator_name": "",
                      "origin_operator_protocol": "", //部署运营商的部署协议
                      "disaster_recovery_strategy": "", //容灾策略,
                      "real_appid": "",
                      "can_replace": "0|1"
                    },
                    "target_channel": {
                      "mode": "static/dynamic",
                      "data": "",
                      "alias": "",
                      "dynamic_mode": "",
                      "site": "",
                      "group": "" // 动态分配是的group信息
                    }
                  }
                ]
              },
              {
                //部署前job设置
                "id": "did:wlk:xxxx#before_deploy_jobs",
                "type": "before_deploy_jobs",
                "data": [
                  {
                    "appid": "0864736569544d30a8c638f9d8294592", //"该job属于哪个appid,verison,channeldata"
                    "version": "1.0.0",
                    "name": "",
                    "target_channel": {
                      "data": ""
                    },
                    "pod_name": "xxxxxxxxxxx", //使用32位生成器生成
                    "pod_instance":"xxxxxxx", //使用32位生成器生成
                    "job_params": { // 下面都位空
                      "data": [], //""
                      "data_string": "", //""
                      "data_schema": {
                        "type": "env", //"
                        "param_type": "data", 
                        "name": "" 
                      }
                    },
                    "related_other_node": [
                    ],
                    "output": {

                      "type": "terminal",
                      "data_schema": "json",
                      "destination": [
                        {
                          "type": "env",
                          "pod_name": "", 
                          "merge_always": "0",
                          "keys_mapping": [
                          ]
                        }
                      ]
                    }
                  }
                ]
              },
              {
                //部署时job设置
                "id": "did:wlk:xxxx#deploying_jobs", // 普通的应用,这条记录里的data为空
                "type": "deploying_jobs",
                "data": [
                  {
                    "name": "",
                    "appid": "",
                    "version": "",
                    "target_channel": {
                      "data": ""
                    },
                    "pod_name": "",
                    "job_params": {
                      "data": [],
                      "data_string": "{{key}}",
                      "data_schema": {
                        "type": "configmap|env", // 表示传进去的方式
                        "param_type": "data|body|data_string", // 表示传什么到容器
                        "name": "" // 表示env的key或者configmap的filename
                      }
                    }
                  }
                ]
              },
              {
                //部署完成的job设置
                "id": "did:wlk:xxxx#deploy_finished_jobs",
                "type": "deploy_finished_jobs",
                "data": [
                  {
                    "name": "",
                    "appid": "appidofacl",
                    "version": "0.0.1",
                    "target_channel": {
                      "data": "dataofacl"
                    },
                    "related_deploy_resource": [{"resource_id": ""}],
                    "pod_name": "",
                    "job_params": {
                      "data": [],
                      "data_string": "",
                      "data_schema": {
                        "type": "configmap|env", // 表示传进去的方式
                        "param_type": "data|body|data_string", // 表示传什么到容器
                        "name": "" // 表示env的key或者configmap的filename
                      }
                    }
                  }
                ]
              },
              {
                //部署方案设置,节点和pod资源指定
                "id": "did:wlk:xxxx#pod_settings",
                "type": "pod_settings",
                "data": [
        {
                            "appid": "0864736569544d30a8c638f9d8294592",
                            "version": "1.0.0",
                            "pod_type": "job", //permanent job loop
                            "pod_runtime_require": "all|pod|vm",
                            "pod_instance":"xxxx",
                            "name": "xxxxxxxxxxxxxxxx", // pod的标识,仅在当前结构下区分
                            "name_literal": "",
                            "replicas": "1", // 开发者默认的副本数
                            "annotation": "backend",
                            "support_ssh": "0|1", // 是否开启ssh
                            "repo_key": "",
                            "init_containers": [],
                            "deploy_labels": [], //"【用户填写】,必填,默认为sidecar,sidecar_without_entry",
                            "health_check_uri": "",
                            "containers": [
                              {
                                "name": "",
                                "args": [],
                                "envs": [
                                  {
                                    "name": "PVC_ZIP_FILE_URL",
                                    "value": ""
                                  },
                                    {
                                        "name": "PVC_UNZIP_FILEPATH",
                                        "value": "/opt/pvc"
                                      }
                                ],
                                "image_url": "harbor.oneitfarm.com/itfarm-test/sal2000089a2f45722050718vpc8pqid:1.0.1", //可以没有,没有通过image_asset从市场获取镜像
                                "command": [], //job的镜像的执行命令
                                "image_asset": "appid@version",
                                "resources": [
                                  {
                                    "type": "qutoa",
                                    "name": "",
                                    "sku_id": "",
                                    "unique_key": "",
                                    "properties": {
                                      "memory_request": "128",
                                      "memory_limit": "128",
                                      "cpu_limit": "1000",
                                      "cpu_request": "100",
                                      "level": "low",
                                      "gpu_request":"9tFlops",
                                      "gpu_limit":""
                                    }
                                  },
                                  {
                                    "type": "pvc",
                                    "name": "pvc1",
                                    "sku_id": "",
                                    "unique_key": "",
                                    "properties": {
                                      "storage": 1, // 容量的最小要求,0标识没有要求
                                      "read_only": false,
                                      "mount_path": "/opt/pvc",
                                      "sub_path": ""
                                    },
                                    "bind_data_set": {"dev_pvc_link":"//s2-cdn.oneitfarm.com/xxxxxx","name":"AI-数据集","publish_pvc_link":"appidxxxxxxx5000@0.0.2","type":"task_dev_api","unique_id":"sal200005a4dc54b2205205dylr047z9"}
                                  }
                                ]
                              }
                            ]
                          }
                  {
                    "appid": "",
                    "version": "",
                    "pod_type": "", //permanent job loop
                    "bind_to_pod": "",
                    "pod_runtime_require": "all|pod|vm",
                    "name": "", // pod的标识,仅在当前结构下区分
                    "name_literal": "",
                    "replicas": "1", // 开发者默认的副本数
                    "annotation": "backend",
                    "support_ssh": "0|1", // 是否开启ssh
                    "repo_key": "",
                    "setting_form": [
                      {
                        "key": "",
                        "name": "",
                        "data_schema": "text|int|date",
                        "value": "",
                        "need_expose": "",
                        "from": ""
                      }
                    ],
                    "cron_jobs":[
                        {
                            "schedule_type":"cron",
                            "scheduler": "",
                            "command": ""
                        }
                    ],
                    "circuit_breaker": [
                      //容灾的触发参数设置
                      {
                        "key": "",
                        "value": ""
                      }
                    ],
                    "circuit_breaker_action": "", // "容灾的行为""【预留】"
                    "networks": [
                      {
                        "need_expose": "0 | 1, 是否需要对外暴露",
                        "need_https": "1, 是否需要https支持",
                        "target_port": "服务端口",
                        "node_port": "将集群LB上的端口映射到target_port, 30000～32767之间",
                        "backend_protocol": "HTTP | GRPC | GRPCS | TCP, 应用层协议",
                        "domain": "自定义域名",
                        "ssl_key_data": "自带https证书key",
                        "ssl_certificate_data": "自带https证书certificate",
                        "proxy_body_size": "",
                        "ssl_passthrough": "true | false, 是否是程序自己验证ssl证书",
                        "white_list": "可以访问pod的ip白名单列表",
                        "ssl_redirect": "0 | 1, 自动转换http到https访问",
                        "cors_allow_origins": "跨域设置",
                        "node_ip": "虚拟机部署的时候需要指定虚拟机ip地址",
                        "domain_prefix": "域名前缀"
                      }
                    ],
                    "init_containers": [],
                    "deploy_labels": [], //"【用户填写】,必填,默认为sidecar,sidecar_without_entry",
                    "health_check_uri": "",
                    "containers": [
                      {
                        "name": "",
                        "args": [],
                        "envs": [
                          {
                            "name": "",
                            "value": ""
                          }
                        ],
                        "image_url": "", //可以没有,没有通过image_asset从市场获取镜像
                        "command": [], //job的镜像的执行命令
                        "image_asset": "appid@version",
                        "resources": [
                          {
                            "type": "mysql|redis|mongo|mysql_db",
                            "use_type": "mysql|mysql_db",
                            "sku_id": "SKUID",
                            "name": "DB1",
                            "unique_key": "",
                            "properties": {
                              "qps": "",
                              "storage": "",
                              "memory": ""
                            },
                            "migrate_version":"1.0.0",
                            "rollback_command":"phinx rollback -t 20190425082333",
                            "migrate_command":"phinx migrate",
                            "bind_data_set":""
                          },
                          {
                            "type": "machine",
                            "sku_id": "",
                            "name": "",
                            "unique_key": "",
                            "properties": {}
                          },
                          {
                            "type": "qutoa",
                            "name": "",
                            "sku_id": "",
                            "unique_key": "",
                            "properties": {
                              "memory_request": "128",
                              "memory_limit": "128",
                              "cpu_limit": "1000",
                              "cpu_request": "100",
                              "level": "low",
                              "gpu_request":"9tFlops",
                              "gpu_limit":""
                            },
                            "levels": [
                              {
                                "level": "low|middile|high",
                                "memory_request": "128",
                                "memory_limit": "128",
                                "cpu_limit": "1000",
                                "cpu_request": "100"
                              }
                            ]
                          },
                          {
                            "type": "pvc",
                            "name": "pvc1",
                            "sku_id": "",
                            "unique_key": "",
                            "properties": {
                              "storage": 1, // 容量的最小要求,0标识没有要求
                              "read_only": false,
                              "mount_path": "tyo/ttt",
                              "sub_path": "ttt"
                            },
                            "bind_data_set":""
                          },
                          {
                            "type": "mysql_instance", //数据库实例,用户不需要部署建库,直接提货
                            "sku_id": "SKUID",
                            "use_type": "mysql_instance",
                            "custom_config": {},
                            "name": "DB1",
                            "unique_key": "",
                            "properties": {
                              //提货提出的信息
                              "host": "10.14.2.18",
                              "port": "3306",
                              "username": "ci123", //root用户
                              "password": "ci1231405"
                            }
                          },
                          {
                            "type": "mysql_db", //提货提到的是数据库实例,需要为用户建库
                            "sku_id": "SKUID",
                            "use_type": "mysql_instance",
                            "name": "DB1",
                            "unique_key": "",
                            "custom_config": {
                              //根据custom_config建表
                              "username": "",
                              "password": "",
                              "db_name": "",
                              "alias": ""
                            },
                            "properties": {
                              //提货提出的信息
                              "host": "10.14.2.18",
                              "port": "3306",
                              "username": "ci123",
                              "password": "ci1231405"
                            }
                          }
                        ],
                        "package_options": {
                          // 聚合打包时的参数
                          "workdir": "/opt/cosmos",
                          "port": 5002,
                          "cmd_paths": ["/opt/cosmos/raft_leveldb"],
                          "cmd_args": ["--port=5002"]
                        },
                        "output":{
                            "type":"terminal",
                            "data_schema":"json",
                            "destination":[],
                            "keys": [
                              {
                                "key": "",
                                "name": "",
                                "data_schema": "text",
                                "value": ""
                              }
                            ]
                          }
                      }
                    ],
                    "circuit_breaker_containers": [
                      //"【预留】"
                      {
                        "name": "",
                        "args": [],
                        "envs": [
                          {
                            "name": "",
                            "value": ""
                          }
                        ],
                        "image_url": "", //可以没有,没有通过image_asset从市场获取镜像
                        "image_asset": "appid@version",
                        "resources": [
                          {
                            "type": "mysql|redis|mongo|mysql_db",
                            "use_type": "mysql|mysql_db",
                            "sku_id": "SKUID",
                            "name": "DB1",
                            "unique_key": "",
                            "properties": {
                              "qps": "",
                              "storage": "",
                              "memory": ""
                            }
                          },
                          {
                            "type": "machine",
                            "sku_id": "",
                            "name": "",
                            "unique_key": "",
                            "properties": {}
                          },
                          {
                            "type": "qutoa",
                            "name": "",
                            "sku_id": "",
                            "unique_key": "",
                            "properties": {
                              "memory_request": "128",
                              "memory_limit": "128",
                              "cpu_limit": "1000",
                              "cpu_request": "100"
                            }
                          },
                          {
                            "type": "pvc",
                            "name": "pvc1",
                            "sku_id": "",
                            "unique_key": "",
                            "properties": {
                              "storage": 1, // 容量的最小要求,0标识没有要求
                              "read_only": false,
                              "mount_path": "tyo/ttt",
                              "sub_path": "ttt"
                            }
                          },
                          {
                            "type": "mysql_db", //库已存在,直接提货
                            "sku_id": "SKUID",
                            "use_type": "mysql_db",
                            "custom_config": {},
                            "name": "DB1",
                            "unique_key": "",
                            "properties": {
                              //提货提出的信息
                              "host": "10.14.2.18",
                              "port": "3306",
                              "db_name": "apollo_portal",
                              "username": "ci123",
                              "password": "ci1231405"
                            },
                            "bind_data_set": "xxxxxx@1.0.1"
                          },
                          {
                            "type": "mysql_instance", //数据库实例,用户不需要部署建库,直接提货
                            "sku_id": "SKUID",
                            "use_type": "mysql_instance",
                            "custom_config": {},
                            "name": "DB1",
                            "unique_key": "",
                            "properties": {
                              //提货提出的信息
                              "host": "10.14.2.18",
                              "port": "3306",
                              "username": "ci123", //root用户
                              "password": "ci1231405"
                            }
                          },
                          {
                            "type": "mysql_db", //提货提到的是数据库实例,需要为用户建库
                            "sku_id": "SKUID",
                            "use_type": "mysql_instance",
                            "name": "DB1",
                            "unique_key": "",
                            "custom_config": {
                              //根据custom_config建表
                              "username": "",
                              "password": "",
                              "db_name": "",
                              "alias": ""
                            },
                            "properties": {
                              //提货提出的信息
                              "host": "10.14.2.18",
                              "port": "3306",
                              "username": "ci123",
                              "password": "ci1231405"
                            }
                          }
                        ]
                      }
                    ],
                    "traction": {
                      // 升级流量牵引策略
                      "type": "", // 金丝雀, 蓝绿
                      "compatible_versions": ["0.1.0", "0.1.1", "0.1.2"],
                      "properties": {
                        "type": "manual|automatic",
                        "steps": [
                          {
                            "step": 0,
                            "old_version_weight": "20",
                            "new_version_weight": "80",
                            "duration": "0" //以秒为单位
                          },
                          {
                            "step": 1,
                            "old_version_weight": "20",
                            "new_version_weight": "80",
                            "duration": "86400"
                          }
                        ]
                      }
                    },
                    "call_back_route": "",
                    "output": {
                      //"【用户填写】job执行返回的数据,输入到终端"
                      "type": "terminal",
                      "data_schema": "json",
                      "destination": [
                        {
                          "type": "env",
                          "pod_name": "", //"【用户填写】job执行返回的数据,输入到哪些podname"
                          "merge_always": "1|0", //"【用户填写】是否在以后升级时永远合并,默认不合并"
                          "keys_mapping": [
                            // 非空的时候提取,空的时候全部打过去
                            {
                              "origin_key": "", //"【用户填写】参数源key"
                              "destination_key": "【用户填写】参数目的key"
                            }
                          ]
                        }
                      ],
                      "keys": [
                        {
                          "key": "",
                          "name": "",
                          "data_schema": "text|int|date",
                          "value": ""
                        }
                      ]
                    },
                    "net_policy": [
                        {
                            "direction":"in|out",
                            "type":"host|ip|port|protocol",
                            "port":"",
                            "identity":"xxxx.com|192.168.0.1|tcp|udp",
                            "action":"block|passthrough"
                        }
                    ]
                  }
                ]
              },
              {
                //产物（全部）的市场信息
                "id": "did:wlk:xxxxxxxx#market",
                "type": "market",
                "data": {
                  "resource_policy": [
                    {
                      "appid": "",
                      "version": "",
                      "site": "",
                      "appkey": "",
                      "channel": "",
                      "market_url": "",
                      "deploy_did": "",
                      "communicate_port": "",
                      "resources_pull": {
                        "image": "0", //0不能拉取,1能拉取
                        "npm": "1",
                        "composer": "1",
                        "deploy_protocol": "1"
                      }
                    }
                  ],
                  "developer_policy": {
                    "is_supply_runtime_monitor": "0|1",
                    "monitor_info": {
                      "develop_space": {
                        "appkey": "xxxxxxxx",
                        "channel": "3",
                        "site": ""
                      },
                      "im": {},
                      "monitor": {
                        "accept_monitor": 0
                      },
                      "cicd": {
                        "appkey": "xxxxxxxxx",
                        "channel": "",
                        "stie": "",
                        "sub_org_key": ""
                      }
                    },
                    "upgrade_condition": "user|developer|developer_assitant"
                  },
                  "upgrade_policy": {}
                }
              },
              {
                "id": "did:wlk:xxxxxxx#channel_pods", // 实例化的部署协议有这个章节
                "type": "channel_pods",
                "data": [
                  {
                    "appid": "",
                    "version": "",
                    "target_channel": {
                      "data": ""
                    },
                    "pods": [
                      {
                        "name": "",
                        "pod_instance": "",
                        "action": "remove|add" // 当这个节点同site迁移的时候,需要
                      }
                    ]
                  }
                ]
              },
              {
                "id": "did:wlk:xxxxxx#data_defines", // 仅在实例化的部署协议并且是导入任务中才有这个章节
                "type": "data_defines",
                "data": [
                  {
                    "appid": "",
                    "version": "",
                    "defines": {
                      "database": [
                        {
                          "db_alias": "DB1",
                          "tables": [
                            {
                              "name": "users",
                              "desc": "表描述",
                              "columns": {
                                "desc": "无用字段",
                                "datatableinfo": [
                                  {
                                    "id": "id",
                                    "name": "字段显示名",
                                    "type": "char",
                                    "long": "11",
                                    "default": "0",
                                    "desc": "主键",
                                    "attrType": "数字"
                                  },
                                  {
                                    "id": "name",
                                    "name": "用户姓名",
                                    "type": "char",
                                    "long": "12",
                                    "default": "人无名",
                                    "desc": "用户名称",
                                    "attrType": ""
                                  },
                                  {
                                    "id": "avatar_id",
                                    "name": "头像id",
                                    "type": "int",
                                    "long": "11",
                                    "default": "0",
                                    "desc": "用户头像",
                                    "attrType": ""
                                  },
                                  {
                                    "id": "table_id",
                                    "name": "外部服务的id",
                                    "type": "int",
                                    "long": "11",
                                    "default": "0",
                                    "desc": "",
                                    "attrType": ""
                                  }
                                ],
                                "index": [
                                  {
                                    "value": ["id"],
                                    "unique": "true"
                                  }
                                ],
                                "key": [
                                  {
                                    "fieldname": "avatar_id",
                                    "foreignkey": "avatar.id"
                                  }
                                ],
                                "releation_key": [
                                  {
                                    "server_appid": "dwagexsetewxafagappid",
                                    "channel_alias": "",
                                    "server_version": "0.0.1",
                                    "server_task_id": "",
                                    "server_db_name": "DB1",
                                    "server_table_name": "",
                                    "fieldname": "table_id",
                                    "server_foreignkey": "table_name.id"
                                  }
                                ]
                              }
                            },
                            {
                              "name": "avatar",
                              "desc": "用户头像表",
                              "columns": {
                                "desc": "无用字段",
                                "datatableinfo": [
                                  {
                                    "id": "id",
                                    "name": "字段显示名",
                                    "type": "char",
                                    "long": "11",
                                    "default": "0",
                                    "desc": "主键",
                                    "attrType": "数字"
                                  },
                                  {
                                    "id": "url",
                                    "name": "头像地址",
                                    "type": "char",
                                    "long": "255",
                                    "default": "",
                                    "desc": "头像地址",
                                    "attrType": ""
                                  }
                                ],
                                "index": [
                                  {
                                    "value": ["id"],
                                    "unique": "true"
                                  }
                                ],
                                "key": [],
                                "releation_key": []
                              }
                            }
                          ]
                        }
                      ],
                      "pvc": [
                        {
                          "name": ""
                        }
                      ],
                      "harbor": [{}],
                      "npm": [{}]
                    }
                  }
                ]
              }
            ]
            
            
            
            
        
        
    
    